<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataDiet</title>
    <link rel="stylesheet" href="home-style.css">
    <link rel="stylesheet" href="heatmaps-style.css">
    <link rel="stylesheet" href="general-info-style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw/dist/leaflet.draw.css" />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
</head>
<body>
    <div id="top-container">
        <div id="sidebar">
            <h2>Select Feature</h2>
            <div id="options">
                <template id="option-template">
                    <label class="option-label">
                        <input type="radio" name="feature" class="option-input">
                        <span class="option-text"></span>
                    </label>
                </template>
            </div>
            <button id="toggle-sidebar"><span class="material-symbols-outlined" id = "forward-logo">arrow_forward_ios</span></button>
        </div>
        <div id="map-gradient">
            <div id="map-container">
                <div class ="map-sec">
                    <h2 class = "map-title" id = "map-title-1">Region 1</h2>
                    <div id="map-1" style="width: 600px; height: 400px;"></div>
                </div>
                <div class="map-sec">
                    <h2 class = "map-title" id = "map-title-2">Region 2</h2>
                    <div id="map-2" style="width: 600px; height: 400px;">
                        <div style="
                        position: absolute; 
                        top: 23px; 
                        right: 10px; /* Adjust as necessary */
                        z-index: 1000;
                        background-color: black; 
                        padding: 5px;
                        padding-left: 30px;
                        border-radius: 5px; 
                    ">
                        <input type="checkbox" id="dataset-checkbox" style="
                            transform: scale(1.5); 
                            cursor: pointer;
                            margin-right: 92px;
                            margin-top: 8px;
                            z-index: 1001;
                        ">
                        <label for="dataset-checkbox" style="
                            color: white; 
                            font-size: 20px; 
                            font-weight: 500; 
                            font-family: Inter;
                        ">
                            Seasonal Heatmap
                        </label>
                    </div>
                    </div>
                </div>
            </div>
            <div id="gradient-box"></div>
        </div>
        <div class="loading-screen" style="display:none;">
            <div class="spinner"></div>
            <p class = "loading-data">Loading data, please wait...</p>
        </div>
    </div>
    <div id="bottom-container">
        <div id="date-sec">
            <h2 id="date-creation-title">Change Date</h2>
            <form action="" id="date-form">
                <div class="date-of-creation-container">
                    <label for="month-dropdown"></label>
                    <select id="month-dropdown" required>
                        <option value="" disabled selected>Month</option>
                        <option value="01">January</option>
                        <option value="02">February</option>
                        <option value="03">March</option>
                        <option value="04">April</option>
                        <option value="05">May</option>
                        <option value="06">June</option>
                        <option value="07">July</option>
                        <option value="08">August</option>
                        <option value="09">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                    <label for="day-dropdown"></label>
                    <select id="day-dropdown" required>
                        <option value="" disabled selected>Day</option>
                        <option value="01">1</option>
                        <option value = "02">2</option>
                        <option value = "03">3</option>
                        <option value = "04">4</option>
                        <option value = "05">5</option>
                        <option value = "06">6</option>
                        <option value = "07">7</option>
                        <option value = "08">8</option>
                        <option value = "09">9</option>
                        <option value = "10">10</option>
                        <option value = "11">11</option>
                        <option value = "12">12</option>
                        <option value = "13">13</option>
                        <option value = "14">14</option>
                        <option value = "15">15</option>
                        <option value = "16">16</option>
                        <option value = "17">17</option>
                        <option value = "18">18</option>
                        <option value = "19">19</option>
                        <option value = "20">20</option>
                        <option value = "21">21</option>
                        <option value = "22">22</option>
                        <option value = "23">23</option>
                        <option value = "24">24</option>
                        <option value = "25">25</option>
                        <option value = "26">26</option>
                        <option value = "27">27</option>
                        <option value = "28">28</option>
                        <option value = "29">29</option>
                        <option value = "30">30</option>
                        <option value="31">31</option>
                    </select>
                    <label for="year-dropdown"></label>
                    <select id="year-dropdown" required>
                        <option value="" disabled selected>Year</option>
                        <option value="2003">1994</option>
                        <option value="2004">1995</option>
                        <option value="2005">1996</option>
                        <option value="2006">1997</option>
                        <option value="2007">1998</option>
                        <option value="2008">1999</option>
                        <option value="2009">2000</option>
                        <option value="2010">2001</option>
                        <option value="2011">2002</option>
                        <option value="2012">2003</option>
                        <option value="2003">2004</option>
                        <option value="2004">2005</option>
                        <option value="2005">2006</option>
                        <option value="2006">2007</option>
                        <option value="2007">2008</option>
                        <option value="2008">2009</option>
                        <option value="2009">2010</option>
                        <option value="2010">2011</option>
                        <option value="2011">2012</option>
                        <option value="2012">2013</option>
                        <option value="2014">2014</option>
                        <option value="2015">2015</option>
                        <option value="2016">2016</option>
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                </select>
            </div>
            <button id="date-submit">Submit</button>
        </form>
        </div>
        <button id="new-region">Select New Region</button>
    </div>
    <div id="warning-container">
        <h2 id="warnings-header">Warnings</h2>
        <template id = "warning-template">
            <div class="warning">
                <h2 class="warning-title"></h2>
            </div>
        </template>
    </div>


    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-draw/dist/leaflet.draw.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
    <script src="https://unpkg.com/@turf/turf/turf.min.js"></script>
    <script src="template.js"></script>
    <script src="database.js"></script>
    <script src="heatmaps.js"></script>

    <script>
        const dataset = JSON.parse(localStorage.getItem('datasets'));
        const featureString = localStorage.getItem("features");
        const features = featureString.split(",");
        const container = document.getElementById("options");
        const template = document.getElementById("option-template");
        for (let i = 0; i<features.length; i++) {
            const clone = document.importNode(template.content, true);
            clone.querySelector(".option-text").textContent = features[i];
            clone.querySelector(".option-input").value = features[i];
            container.append(clone);
        }

        const optionLabels = document.querySelectorAll('.option-label');

        container.addEventListener('click', (event) => {
            const label = event.target.closest('.option-label');
            if (label) {
            document.querySelectorAll('.option-label').forEach((lbl) => 
                lbl.classList.remove('pressed')
            );
            label.classList.add('pressed');
            }
        });
        const title1 = document.getElementById('map-title-1');
        const day = dataset[0].day;
        const month = dataset[0].month;
        const year = dataset[0].year;
        title1.textContent += ` (${month}/${day}/${year})`;
        const title2 = document.getElementById('map-title-2');
        title2.textContent += ` (${month}/${day}/${year})`;
        document.getElementById("new-region").addEventListener("click", function() {
            window.location.href = "selectRegion.html";
        });
        document.getElementById("date-submit").addEventListener("click", function() {
            let selectedMonth = document.getElementById('month-dropdown').value;
            let selectedDay = document.getElementById('day-dropdown').value;
            let selectedYear = document.getElementById('year-dropdown').value;
            let dataset = localStorage.getItem("datasets");

            if (dataset) {
                dataset = JSON.parse(dataset);

                dataset[0].month = selectedMonth;
                dataset[0].day = selectedDay; 
                dataset[0].year = selectedYear; 
                localStorage.setItem("datasets", JSON.stringify(dataset));
            loadHeatMaps(points1, selectedRadio.value, area1);
         };
        });
    </script>
</body>
</html>
